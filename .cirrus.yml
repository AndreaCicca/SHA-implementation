task:
  arm_container:
    image: ubuntu:20.04

  environment:
    CONAN_USER_HOME: /root/.conan2

  setup_script:
    # Installa git, Conan, e strumenti di compilazione C++
    - sudo apt update
    - sudo apt install -y git python3-pip g++ cmake build-essential

    # Installa Conan
    - pip3 install conan

  checkout_script:
    - git clone https://github.com/AndreaCicca/SHA-implementation .
    - git checkout main

  install_script:
    # Crea il profilo di Conan e directory build
    - conan profile detect --force
    - mkdir -p src/build

  build_script:
    # Installa le dipendenze con Conan e build con CMake
    - conan install src --output-folder=src/build --build=missing
    - cmake -S src -B src/build --preset conan-release
    - cmake --build src/build
